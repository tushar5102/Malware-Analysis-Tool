import winreg
import time

# Specify the registry key to monitor
registry_key = r"SOFTWARE\Microsoft\Windows\CurrentVersion\Run"

# Open the registry key for monitoring
key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, registry_key, 0, winreg.KEY_READ)

# Get the initial number of subkeys and values under the key
initial_subkey_count, initial_value_count, _ = winreg.QueryInfoKey(key)

print("Monitoring registry key", registry_key)

while True:
    # Wait for 1 second before checking for changes
    time.sleep(1)
    
    # Get the current number of subkeys and values under the key
    current_subkey_count, current_value_count, _ = winreg.QueryInfoKey(key)
    
    # Compare the current and initial counts to detect changes
    if current_subkey_count != initial_subkey_count or current_value_count != initial_value_count:
        print("Registry key has changed!")
        print(f"Initial subkey count: {initial_subkey_count}, current subkey count: {current_subkey_count}")
        print(f"Initial value count: {initial_value_count}, current value count: {current_value_count}")
        break
